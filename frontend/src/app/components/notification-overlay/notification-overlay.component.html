<div
  class="alert-shell"
  appTauriDragWindow
  data-tauri-drag-region
  *ngIf="current() as n"
  (dblclick)="toggleExpand()"
>
  <div class="alert-card">
    <button
      class="alert-close"
      type="button"
      aria-label="Отложить уведомление"
      (click)="snooze()"
      data-tauri-drag-region="false"
    >
      <mat-icon>close</mat-icon>
    </button>
    <div class="alert-content" data-tauri-drag-region="false">

      <div class="alert-title">
        {{ n.subject || '(без темы)' }}
        <span class="alert-date" *ngIf="n.receivedAt as received">
          {{ formatDate(received) }}
        </span>

      </div>
      <div class="alert-sender" *ngIf="n.sender">
        <strong>От:</strong> {{ decodeHtmlEntities(n.sender) }}
      </div>
      <div class="alert-recipient" *ngIf="n.recipient">
        <strong>Кому:</strong> {{ decodeHtmlEntities(n.recipient) }}
      </div>
      <div class="alert-snippet" *ngIf="!isExpanded()">{{ n.snippet || '' }}</div>

      <!-- Развёрнутое содержимое письма -->
      <div class="alert-body" *ngIf="isExpanded() && n.body" [innerHTML]="n.body"></div>
    </div>
    <div class="alert-actions" data-tauri-drag-region="false">
      <button class="open" (click)="open()">Перейти</button>
      <button class="read" (click)="markRead()">Прочитано</button>
      <button class="snooze" (click)="snooze()">Отложить</button>
    </div>
  </div>
</div>
